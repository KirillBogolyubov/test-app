{"ast":null,"code":"import { vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, withModifiers as _withModifiers, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"form\"\n};\nconst _hoisted_2 = {\n  class: \"form__input\"\n};\nconst _hoisted_3 = {\n  class: \"form__input\"\n};\nconst _hoisted_4 = {\n  class: \"form__input\"\n};\nexport function render(_ctx, _cache) {\n  return _openBlock(), _createElementBlock(\"section\", null, [_createElementVNode(\"form\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_withDirectives(_createElementVNode(\"input\", {\n    id: \"price\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _ctx.price = $event),\n    type: \"number\",\n    onInput: _cache[1] || (_cache[1] = $event => _ctx.calculateFields('price'))\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, _ctx.price]]), _cache[7] || (_cache[7] = _createElementVNode(\"label\", {\n    for: \"price\"\n  }, \"Цена\", -1 /* HOISTED */))]), _createElementVNode(\"div\", _hoisted_3, [_withDirectives(_createElementVNode(\"input\", {\n    id: \"quantity\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _ctx.quantity = $event),\n    type: \"number\",\n    onInput: _cache[3] || (_cache[3] = $event => _ctx.calculateFields('quantity'))\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, _ctx.quantity]]), _cache[8] || (_cache[8] = _createElementVNode(\"label\", {\n    for: \"quantity\"\n  }, \"Количество\", -1 /* HOISTED */))]), _createElementVNode(\"div\", _hoisted_4, [_withDirectives(_createElementVNode(\"input\", {\n    id: \"amount\",\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => _ctx.amount = $event),\n    onInput: _cache[5] || (_cache[5] = $event => _ctx.calculateFields('amount'))\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, _ctx.amount]]), _cache[9] || (_cache[9] = _createElementVNode(\"label\", {\n    for: \"amount\"\n  }, \"Сумма\", -1 /* HOISTED */))]), _createElementVNode(\"button\", {\n    onClick: _cache[6] || (_cache[6] = _withModifiers((...args) => _ctx.postAmount && _ctx.postAmount(...args), [\"stop\", \"prevent\"]))\n  }, \"Отправить\")]), _createElementVNode(\"div\", null, \"localStorage: \" + _toDisplayString(_ctx.localStorageData), 1 /* TEXT */), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.events, (item, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index\n    }, _toDisplayString(item.message), 1 /* TEXT */);\n  }), 128 /* KEYED_FRAGMENT */))]);\n}","map":{"version":3,"names":["class","_createElementBlock","_createElementVNode","_hoisted_1","_hoisted_2","id","_cache","$event","_ctx","price","type","onInput","calculateFields","for","_hoisted_3","quantity","_hoisted_4","amount","onClick","_withModifiers","args","postAmount","_toDisplayString","localStorageData","_Fragment","_renderList","events","item","index","key","message"],"sources":["/Users/kirill/WebstormProjects/test-app/src/App.vue"],"sourcesContent":["<template>\n  <section>\n    <form class=\"form\">\n      <div class=\"form__input\">\n        <input id=\"price\" v-model=\"price\" type=\"number\" @input=\"calculateFields('price')\" />\n        <label for=\"price\">Цена</label>\n      </div>\n      <div class=\"form__input\">\n        <input id=\"quantity\" v-model=\"quantity\" type=\"number\" @input=\"calculateFields('quantity')\" />\n        <label for=\"quantity\">Количество</label>\n      </div>\n      <div class=\"form__input\">\n        <input id=\"amount\" v-model=\"amount\" @input=\"calculateFields('amount')\" />\n        <label for=\"amount\">Сумма</label>\n      </div>\n      <button @click.stop.prevent=\"postAmount\">Отправить</button>\n    </form>\n    <div>localStorage: {{localStorageData}}</div>\n    <div v-for=\"(item, index) in events\" :key=\"index\">{{item.message}}</div>\n  </section>\n</template>\n\n<script setup>\nimport {computed, ref} from \"vue\";\n\nconst price = ref(0);\nconst quantity = ref(0);\nconst amount = ref(0);\nconst counter = ref(0);\nconst events = ref([]);\nconst localStorageData = computed(() => {\n  return JSON.parse(localStorage.getItem('data') || '{}')\n});\n\n\nconst calculateFields = (changedField) => {\n  setTimeout(() => {\n    if (changedField === 'price' || changedField === 'quantity') {\n      amount.value = price.value * quantity.value\n    }\n    else if (changedField === 'amount') {\n      if (price.value) {\n        quantity.value = amount.value / price.value\n      } else if (quantity.value) {\n        price.value = amount.value / quantity.value\n      }\n    }\n  }, 300)\n  saveEvent(`Изменено поле: ${changedField}`, {\n    price: price.value,\n    quantity: quantity.value,\n    amount: amount.value\n  })\n}\n\nconst saveEvent = (message, data = null) => {\n  const event = {\n    message,\n    data\n  }\n  events.value.unshift(event)\n}\n\nconst postAmount = () => {\n  const data = {\n    counter: counter.value++,\n    price: price.value,\n    quantity: quantity.value,\n    amount: amount.value,\n  }\n\n  console.log(JSON.parse(localStorage.getItem('data')))\n\n  saveEvent('Отправка данных', {\n    submitted: data,\n    localStorageBefore: JSON.parse(localStorage.getItem('data'))\n  })\n\n  serverRequest(data).then((res) => {\n    // localStorage.setItem('data', JSON.stringify(data))\n    console.log(res)\n    saveEvent('Response', {\n      res.value,\n      localStorageAfter: JSON.parse(localStorage.getItem('data') || '{}')\n    })\n  }).catch(err => {\n    saveEvent('Response', {err})\n    throw new Error(err.message)\n  })\n\n}\n\nconst serverRequest = (data) => {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      const isSuccessRequest = data.amount % 2 === 0\n\n      if (isSuccessRequest) {\n        localStorage.setItem('data', JSON.stringify(data))\n        resolve({success: true})\n      } else {\n        reject({success: false})\n      }\n    }, 1000)\n  })\n}\n</script>\n\n<style lang=\"scss\">\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n\n.form {\n  display: flex;\n  column-gap: 10px;\n  margin-bottom: 20px;\n\n  &__input {\n    display: flex;\n    flex-direction: column;\n  }\n}\n</style>\n"],"mappings":";;EAEUA,KAAK,EAAC;AAAM;;EACXA,KAAK,EAAC;AAAa;;EAInBA,KAAK,EAAC;AAAa;;EAInBA,KAAK,EAAC;AAAa;;uBAV5BC,mBAAA,CAkBU,kBAjBRC,mBAAA,CAcO,QAdPC,UAcO,GAbLD,mBAAA,CAGM,OAHNE,UAGM,G,gBAFJF,mBAAA,CAAoF;IAA7EG,EAAE,EAAC,OAAO;IAJzB,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAImCC,IAAA,CAAAC,KAAK,GAAAF,MAAA;IAAEG,IAAI,EAAC,QAAQ;IAAEC,OAAK,EAAAL,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,IAAA,CAAAI,eAAe;iEAA5CJ,IAAA,CAAAC,KAAK,E,6BAChCP,mBAAA,CAA+B;IAAxBW,GAAG,EAAC;EAAO,GAAC,MAAI,qB,GAEzBX,mBAAA,CAGM,OAHNY,UAGM,G,gBAFJZ,mBAAA,CAA6F;IAAtFG,EAAE,EAAC,UAAU;IAR5B,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAQsCC,IAAA,CAAAO,QAAQ,GAAAR,MAAA;IAAEG,IAAI,EAAC,QAAQ;IAAEC,OAAK,EAAAL,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,IAAA,CAAAI,eAAe;iEAA/CJ,IAAA,CAAAO,QAAQ,E,6BACtCb,mBAAA,CAAwC;IAAjCW,GAAG,EAAC;EAAU,GAAC,YAAU,qB,GAElCX,mBAAA,CAGM,OAHNc,UAGM,G,gBAFJd,mBAAA,CAAyE;IAAlEG,EAAE,EAAC,QAAQ;IAZ1B,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAYoCC,IAAA,CAAAS,MAAM,GAAAV,MAAA;IAAGI,OAAK,EAAAL,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,IAAA,CAAAI,eAAe;iEAA/BJ,IAAA,CAAAS,MAAM,E,6BAClCf,mBAAA,CAAiC;IAA1BW,GAAG,EAAC;EAAQ,GAAC,OAAK,qB,GAE3BX,mBAAA,CAA2D;IAAlDgB,OAAK,EAAAZ,MAAA,QAAAA,MAAA,MAfpBa,cAAA,KAAAC,IAAA,KAemCZ,IAAA,CAAAa,UAAA,IAAAb,IAAA,CAAAa,UAAA,IAAAD,IAAA,CAAU;KAAE,WAAS,E,GAEpDlB,mBAAA,CAA6C,aAAxC,gBAAc,GAAAoB,gBAAA,CAAEd,IAAA,CAAAe,gBAAgB,mB,kBACrCtB,mBAAA,CAAwEuB,SAAA,QAlB5EC,WAAA,CAkBiCjB,IAAA,CAAAkB,MAAM,EAlBvC,CAkBiBC,IAAI,EAAEC,KAAK;yBAAxB3B,mBAAA,CAAwE;MAAlC4B,GAAG,EAAED;IAAK,GAAAN,gBAAA,CAAIK,IAAI,CAACG,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}